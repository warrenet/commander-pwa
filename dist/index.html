<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0a0a0f">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="description" content="Commander - Your daily execution cockpit">

  <title>Commander</title>

  <link rel="icon" type="image/png" href="./assets/icon-192-DFhrtoGp.png">
  <link rel="apple-touch-icon" href="./assets/icon-192-DFhrtoGp.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <script type="module" crossorigin src="./assets/main-Cx2MOguQ.js"></script>
  <link rel="modulepreload" crossorigin href="./assets/style-eV2glYNL.js">
  <link rel="stylesheet" crossorigin href="./assets/style-DA7kSADH.css">
<link rel="manifest" href="./manifest.webmanifest"><script id="vite-plugin-pwa:register-sw" src="./registerSW.js"></script></head>

<body>
  <!-- Status Bar -->
  <header class="status-bar">
    <div class="status-left">
      <span class="status-title">âš¡ Commander</span>
      <span class="offline-indicator" id="offlineIndicator" hidden>ğŸŸ¢ Offline Ready</span>
    </div>
    <div class="status-right">
      <span class="today-shipped" id="todayShipped">0 shipped</span>
      <span class="status-indicator" id="saveStatus">Ready</span>
    </div>
  </header>

  <!-- Main Content: Tasks View -->
  <main class="commander-container" id="commander">
    <!-- Sections rendered by JS -->
  </main>

  <!-- Main Content: Capture View -->
  <main class="capture-container" id="captureView" hidden>
    <!-- Capture Input Area -->
    <section class="capture-input-section">
      <textarea id="captureTextarea" class="capture-textarea" placeholder="Paste or type anything here..."
        rows="6"></textarea>

      <div class="capture-actions">
        <button class="capture-btn capture-btn-paste" id="pasteBtn">
          ğŸ“‹ Paste
        </button>

        <button class="capture-btn capture-btn-mic" id="micBtn" aria-label="Voice Capture" hidden>
          ğŸ™ï¸
        </button>

        <div class="capture-route-select">
          <label for="routeSelect">Save to:</label>
          <select id="routeSelect" class="route-select">
            <option value="logs">ğŸ“ Logs</option>
            <option value="inbox">ğŸ“¥ Inbox</option>
            <option value="next">ğŸ“‹ Next</option>
            <option value="shipToday">ğŸš€ Ship Today</option>
          </select>
        </div>

        <button class="capture-btn capture-btn-save" id="saveLogBtn">
          ğŸ’¾ Save
        </button>
      </div>
      <div class="capture-templates">
        <button class="capture-btn capture-btn-template" id="templateBtn">
          ğŸ“‹ New from Template
        </button>
      </div>
    </section>

    <!-- Search -->
    <section class="logs-search-section">
      <input type="search" id="logsSearch" class="logs-search-input" placeholder="ğŸ” Search logs...">
    </section>

    <!-- Recent Logs List -->
    <section class="logs-list-section">
      <h3 class="logs-list-header">
        Recent Logs <span class="logs-count" id="logsCount">0</span>
      </h3>
      <ul class="logs-list" id="logsList">
        <!-- Rendered by JS -->
      </ul>
    </section>
  </main>

  <!-- Bottom Action Bar -->
  <nav class="action-bar">
    <button class="action-btn action-btn-tab active" data-action="view-tasks" aria-label="Tasks View">
      <span class="action-icon">ğŸ“‹</span>
      <span class="action-label">Tasks</span>
    </button>
    <button class="action-btn" data-action="add-inbox" aria-label="Add to Inbox">
      <span class="action-icon">+</span>
      <span class="action-label">Inbox</span>
    </button>
    <button class="action-btn action-btn-primary" data-action="add-ship" aria-label="Add to Ship Today">
      <span class="action-icon">ğŸš€</span>
      <span class="action-label">Ship</span>
    </button>
    <button class="action-btn action-btn-tab" data-action="view-capture" aria-label="Capture View">
      <span class="action-icon">ğŸ“</span>
      <span class="action-label">Capture</span>
    </button>
    <button class="action-btn action-btn-menu" data-action="menu" aria-label="Menu">
      <span class="action-icon">â‹®</span>
    </button>
  </nav>

  <!-- Context Menu (Move/Delete/Ship) -->
  <div class="context-menu" id="contextMenu" hidden>
    <div class="context-menu-header">Move to:</div>
    <button class="context-btn" data-move="inbox">ğŸ“¥ Inbox</button>
    <button class="context-btn" data-move="next">ğŸ“‹ Next</button>
    <button class="context-btn" data-move="shipToday">ğŸš€ Ship Today</button>
    <hr class="context-divider">
    <button class="context-btn context-btn-success" data-action="mark-shipped">âœ… Mark as Shipped</button>
    <hr class="context-divider">
    <button class="context-btn context-btn-danger" data-action="delete">ğŸ—‘ï¸ Delete</button>
    <button class="context-btn" data-action="cancel">Cancel</button>
  </div>

  <!-- Log Context Menu -->
  <div class="context-menu" id="logContextMenu" hidden>
    <div class="context-menu-header">Log Actions:</div>
    <button class="context-btn" data-log-action="copy">ğŸ“‹ Copy Content</button>
    <button class="context-btn" data-log-action="send-inbox">ğŸ“¥ Send to Inbox</button>
    <button class="context-btn" data-log-action="send-ship">ğŸš€ Send to Ship</button>
    <hr class="context-divider">
    <button class="context-btn context-btn-danger" data-log-action="delete">ğŸ—‘ï¸ Delete Log</button>
    <button class="context-btn" data-log-action="cancel">Cancel</button>
  </div>

  <!-- Menu Modal -->
  <div class="modal-overlay" id="menuOverlay" hidden>
    <div class="modal">
      <div class="modal-header">
        <h2>Commander Menu</h2>
        <button class="modal-close" data-action="close-menu">Ã—</button>
      </div>
      <div class="modal-body">
        <button class="menu-btn" data-action="export-md">ğŸ“„ Export as Markdown</button>
        <button class="menu-btn" data-action="export-json">ğŸ’¾ Export as JSON</button>
        <hr class="menu-divider">
        <button class="menu-btn menu-btn-primary" data-action="backup">ğŸ“¦ Export Full Backup</button>
        <button class="menu-btn" data-action="restore">ğŸ“‚ Restore from Backup</button>
        <hr class="menu-divider">
        <button class="menu-btn" data-action="undo">â†©ï¸ Undo Last Action</button>
        <hr class="menu-divider">
        <button class="menu-btn" data-action="view-shipped">ğŸš€ View Shipped Items</button>
        <hr class="menu-divider">
        <button class="menu-btn" data-action="diagnostics">ğŸ› ï¸ Diagnostics</button>
        <button class="menu-btn" data-action="weekly-export">ğŸ“… Weekly Export for AI</button>
        <hr class="menu-divider">
        <button class="menu-btn menu-btn-danger" data-action="clear-all">ğŸ—‘ï¸ Clear All (Confirm)</button>
      </div>
    </div>
  </div>

  <!-- Confirm Modal -->
  <div class="modal-overlay" id="confirmOverlay" hidden>
    <div class="modal modal-confirm">
      <div class="modal-header">
        <h2 id="confirmTitle">Confirm</h2>
      </div>
      <div class="modal-body">
        <p id="confirmMessage">Are you sure?</p>
        <div class="modal-actions">
          <button class="btn btn-cancel" data-action="confirm-cancel">Cancel</button>
          <button class="btn btn-danger" data-action="confirm-yes">Yes, Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Ship Modal -->
  <div class="modal-overlay" id="shipOverlay" hidden>
    <div class="modal">
      <div class="modal-header">
        <h2>ğŸš€ Mark as Shipped</h2>
        <button class="modal-close" data-action="close-ship">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="ship-field">
          <label for="shipSaveAs">Save As (required)</label>
          <input type="text" id="shipSaveAs" placeholder="e.g., Auth_Flow_v1">
        </div>
        <div class="ship-field">
          <label for="shipDoD">Definition of Done (required)</label>
          <input type="text" id="shipDoD" placeholder="e.g., PR merged, tests pass">
        </div>
        <div class="modal-actions">
          <button class="btn btn-cancel" data-action="cancel-ship">Cancel</button>
          <button class="btn btn-primary" data-action="confirm-ship">ğŸš€ Ship It!</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Template Modal -->
  <div class="modal-overlay" id="templateOverlay" hidden>
    <div class="modal">
      <div class="modal-header">
        <h2>ğŸ“‹ Choose Template</h2>
        <button class="modal-close" data-action="close-template">Ã—</button>
      </div>
      <div class="modal-body" id="templateList">
        <!-- Rendered by JS -->
      </div>
    </div>
  </div>

  <!-- Diagnostics Modal -->
  <div class="modal-overlay" id="diagOverlay" hidden>
    <div class="modal">
      <div class="modal-header">
        <h2>ğŸ› ï¸ Diagnostics</h2>
        <button class="modal-close" data-action="close-diag">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="diag-section">
          <div class="diag-item">
            <span class="diag-label">App Version:</span>
            <span class="diag-value" id="diagVersion">-</span>
          </div>
          <div class="diag-item">
            <span class="diag-label">Schema Version:</span>
            <span class="diag-value" id="diagSchema">-</span>
          </div>
          <div class="diag-item">
            <span class="diag-label">Service Worker:</span>
            <span class="diag-value" id="diagSW">-</span>
          </div>
          <div class="diag-item">
            <span class="diag-label">Last Updated:</span>
            <span class="diag-value" id="diagUpdated">-</span>
          </div>
          <div class="diag-item">
            <span class="diag-label">Items:</span>
            <span class="diag-value" id="diagCounts">-</span>
          </div>
        </div>
        <hr class="menu-divider">
        <button class="menu-btn" data-action="check-update">ğŸ”„ Check for Update</button>
        <button class="menu-btn" data-action="export-debug">ğŸ“Š Export Debug Bundle</button>
        <button class="menu-btn menu-btn-danger" data-action="reset-cache">ğŸ—‘ï¸ Reset Cache (Last Resort)</button>
      </div>
    </div>
  </div>

  <!-- Hidden file input for import -->
  <input type="file" id="importInput" accept=".json" hidden>
  <input type="file" id="restoreInput" accept=".json" hidden>

</body>

</html>